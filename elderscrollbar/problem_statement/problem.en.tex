\problemname{Elder Scrollbar}

\illustration{.3}{img/Vertical_scroll_bar_with_text_box.png}{A window with scrollbar from more recent times.
 License, public domain.}

When the first scrollbars appeared on resizable windows during user interface development in the Elder Days, computer graphics were still primitive.
Widgets were made with ASCII symbols and text was monospaced.
A window displayed a \emph{viewport}: a part of a much longer text, adjusted to fit the width of the window.
The \emph{thumb}, shown as an X, represented the position of the viewport relative to the full (adjusted) text and allowed vertical nagivation by clicking and dragging.

Alas, much of the knowledge of the Ancients has been lost in the Great Purge of the Second Iconoclast Uprising, which destroyed the last remaining implementations of the user interface layer of the Elder GUI. 
As head programmer of the National Laboratory of Comparative User Interface Archeology it is your job to recreate the behaviour of the machines of yore as faithfully as possible.

Thanks to many years of studies, you have full understanding of the typographical aesthetics of the Elder Days:
Lines were set flush left but ragged-right, and exactly one space separated words on the same line. 
Line-breaking was simple in those days:
When the next word of the text fit on the current line, it was put there, otherwise a new line was started.
If a word was too wide to fit the viewport, it was set on a line of its own and truncated at the right margin.

The language of the Ancients was written in upper- and lowercase letters of the English alphabet without punctuation or hyphenation.
The scroll bar on the right contained navigation widgets for ``up'' and ``down'' at the top and bottom. 
The position of the thumb represented the relative position of the viewport in the adjusted text, but the precise details are lost.


\section*{Input}

The first line conists of $4$ integers $W$, $H$, $F$, $N$, separated by a single space.
The width of the viewport is $W$, with $3\leq W\leq 200$.
The height of the viewport is $H$, with $3\leq H\leq 200$.
The viewport must show line $F$ of the adjusted input as the first line at the top line; lines are numbered $0,\ldots, L-1$, where $L$ is the total number of lines in the adjusted text; you can assume $0\leq F \leq L - H$ and $H < L$.
The following $N$ lines for $1\leq N\leq 30,000$ contain the text (not adjusted), between 1 and 80~characters per line, including spaces; neither the first nor last character in each line are a space.
No word in the language of the Ancients was more than 80~characters.

\section*{Output}

Print the window as the Ancients would have seen it, built from minus (\verb!-!), plus (\verb!+!), pipe (\verb!|!), lower-case V (\verb!v!), caret (\verb!^!), and upper-case X (\verb!X!).
See the sample output for the details.
